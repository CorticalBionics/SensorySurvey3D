import{S as f,C as u,a as b,b as g,o as l,p as C,u as v,V as p,d as E,e as h}from"./common-Cvkf8e95.js";/* empty css                     */document.title="Experimenter - SensorySurvey3D";var n,a,o,d,i,c=null;const S="/experimenter-ws";var t;function w(){t=new WebSocket(S),t.onopen=function(){console.log("Socket connected!"),t.send(JSON.stringify({type:"requestConfig"})),i||(i=setInterval(function(){const e={type:"requestSurvey"};t.send(JSON.stringify(e))},1e3))},t.onmessage=function(e){const s=JSON.parse(e.data);switch(s.type){case"survey":if(o.survey=new E,o.survey.fromJSON(s.survey),d.update(o.survey,c),c===null){const r=document.getElementsByClassName("eyeButton");r[0]&&r[0].dispatchEvent(new Event("pointerup"))}l("currentSurveyTab");break;case"config":const y=document.getElementById("participantSelect");y.innerHTML="";for(var m in s.config){const r=document.createElement("option");r.innerHTML=m,r.value=m,y.appendChild(r)}break;case"noSurvey":o.clearSurvey(),d.clear(),n.unloadCurrentMesh(),c=null,l("newSurveyTab");break}},t.onclose=function(){console.log("Connection to websocket @ ",S," closed. Attempting reconnect in 1 second."),clearInterval(i),setTimeout(function(){w()},1e3)},t.onerror=function(e){console.error("Websocket error: ",e.message),t.close()}}function k(){const s={type:"start",subject:document.getElementById("participantSelect").value};t.send(JSON.stringify(s))}function I(e){e.model&&n.replaceCurrentMesh(o.survey.config.models[e.model],e.vertices,new u("#abcabc"))&&a.reset(),e.hotSpot.x?(n.orbMesh.position.copy(new p(e.hotSpot.x,e.hotSpot.y,e.hotSpot.z)),n.orbMesh.visible=!0):(n.orbMesh.position.copy(new p(0,0,0)),n.orbMesh.visible=!1),o.currentField=e,c=o.survey.projectedFields.indexOf(e)}window.onload=function(){n=new f(document.getElementById("3dContainer"),new u(16777215),new u(5460819),20),a=new b(n.controls,n.renderer.domElement,2,20),a.createZoomSlider(document.getElementById("cameraControlContainer")),a.createCameraReset(document.getElementById("cameraControlContainer")),o=new h,d=new g(document.getElementById("fieldListParent"),!1,I,null,null,null),w(),l("newSurveyTab"),C(v.LEFT,v.TOP);const e=document.getElementById("newSurvey");e.onpointerup=k,n.animate()};
